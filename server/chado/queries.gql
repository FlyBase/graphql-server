query AllelesByGene(
  $fbgn: String!
  $isConstruct: Boolean = false
  $geneIsRegulatoryRegion: Boolean = false
) {
  allGenes(condition: { uniquename: $fbgn }) {
    nodes {
      name
      uniquename
      allelesByGeneId(
        condition: {
          isConstruct: $isConstruct
          geneIsRegulatoryRegion: $geneIsRegulatoryRegion
        }
      ) {
        nodes {
          ...alleleFields
        }
      }
    }
  }
}

query InsertionsWithoutAllelesByGene($fbgn: String!) {
  allGenes(condition: { uniquename: $fbgn }) {
    nodes {
      name
      uniquename
      insertionsByGeneId {
        nodes {
          fbtiId
          symbol
          stocksCount
          pubCount
          constructsByInsertionId {
            nodes {
              fbtpId
              symbol
              toolUsesByConstructId {
                nodes {
                  ...toolUses
                }
              }
              toolsByConstructId {
                nodes {
                  ...toolFields
                }
              }
            }
          }
        }
      }
    }
  }
}

query Allele($fbal: String!) {
  allAlleles(condition: { fbalId: $fbal }) {
    nodes {
      ...alleleFields
    }
  }
}

query Alleles($fbal_ids: [String]!) {
  allelesByFbal(ids: $fbal_ids) {
    nodes {
      ...alleleFields
    }
  }
}

fragment alleleFields on Allele {
  symbol
  fbalId
  isConstruct
  propagateTransgenicUses
  geneIsRegulatoryRegion
  stocksCount
  pubCount
  knownLesion
  hasImage
  alleleClassesByAlleleId {
    nodes {
      fbcvId
      name
    }
  }
  alleleMutagensByAlleleId {
    nodes {
      fbcvId
      name
    }
  }
  insertionsByAlleleId {
    nodes {
      fbtiId
      symbol
      constructsByInsertionId {
        nodes {
          fbtpId
          symbol
          toolUsesByConstructId {
            nodes {
              ...toolUses
            }
          }
          toolsByConstructId {
            nodes {
              ...toolFields
            }
          }
        }
      }
    }
  }
  constructsByAlleleId {
    nodes {
      fbtpId
      symbol
      toolsByConstructId {
        nodes {
          ...toolFields
        }
      }
      toolUsesByConstructId {
        nodes {
          ...toolUses
        }
      }
    }
  }
  toolsByAlleleId {
    nodes {
      ...toolFields
    }
  }
  toolUsesByAlleleId {
    nodes {
      ...toolUses
    }
  }
}

fragment toolFields on Tool {
  fbid
  symbol
  relType
  toolUsesByToolId {
    nodes {
      ...toolUses
    }
  }
}

fragment toolUses on ToolUse {
  fbcvId
  name
}
